# Spring Cloud Services CLI plugin

This repository provides a [Cloud Foundry CLI](https://github.com/cloudfoundry/cli) plugin for
Spring Cloud Services.

For information on plugin development, see
[Developing a plugin](https://github.com/cloudfoundry/cli/tree/master/plugin/plugin_examples).

## Setting up

1. [Install Go](https://golang.org/doc/install) (development of this plugin began with Go 1.7.x.)
2. Set `$GOPATH` to point to a suitable directory such as `~/go`.
This is where Go source code, except for that of the Go standard library, will reside.
**The rest of this README assumes that `$GOPATH` consists of a single directory.**
3. Ensure that your `$PATH` includes `$GOPATH/bin`.
4. Clone this repository (into `$GOPATH/src`):

    ```bash
    $ go get -u github.com/pivotal-cf/spring-cloud-services-cli-plugin
    ```
5. Change the remote of the cloned repository if you want to push changes.

6. External dependencies are managed using [Govendor](https://github.com/kardianos/govendor).
Essentially, dependencies are checked in to the `/vendor` directory. Please refer to Govendor's documentation for information on how to add new dependencies or modify
existing ones. Install Govendor as follows:

    ```bash
    $ go get -u github.com/kardianos/govendor
    ```

## Building

To build the plugin, issue:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin
$ govendor install +local
```

## Installing

To install the plugin in the `cf` CLI, first build it and then issue:
```bash
$ cf install-plugin -f $GOPATH/bin/spring-cloud-services-cli-plugin

```

The plugin's commands may then be listed by issuing `cf help`.

## Testing

Run the tests as follows:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin
$ govendor test +local
```

Tests are written using the [Ginkgo](https://onsi.github.io/ginkgo/) BDD testing framework
and the [Gomega](http://onsi.github.io/gomega/) matcher library, which are included in the `/vendor`
directory.

To run tests using Ginkgo, install the executable as follows:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin
$ go install github.com/onsi/ginkgo/ginkgo
```
and then change directory to a specific package and
run Ginkgo from there. For example:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin/eureka
$ ginkgo -cover -race
```

## Developing

### Editing

Many [Go IDEs and editor plugins]((https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins)) are available.
IntelliJ IDEA users may prefer the [Go plugin](https://github.com/go-lang-plugin-org/go-lang-idea-plugin).

### Coding Standards

See [Effective Go](https://golang.org/doc/effective_go.html) for tips on writing good Go code.
Dip into the code of the Go standard libraries to get a better feel for idiomatic style.

Format code to the Go standard as necessary by issuing:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin
$ govendor fmt +local
```

### Mocking

Test mocks are created using [Counterfeiter](https://github.com/maxbrunsfeld/counterfeiter), which is included in the `/vendor`
directory. Install the `counterfeiter` executable as follows:
```bash
$ cd $GOPATH/src/github.com/pivotal-cf/spring-cloud-services-cli-plugin
$ go install github.com/maxbrunsfeld/counterfeiter
```

Interfaces to be mocked are tagged `//go:generate counterfeiter ...` and so mocks may
be regenerated by issuing:
```bash
$ go generate github.com/pivotal-cf/spring-cloud-services-cli-plugin/...
```
